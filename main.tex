%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Preamble
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[twocolumn, 12pt]{article}
\input{preamble}

\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Title, tagline and cover image
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{strip}

{
    \fontsize{24pt}{24pt}\selectfont
    Xsuite: Open Software for Modern Accelerator Modeling
}\\




\end{strip}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Motivation and Background
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \textbf{Szymon}
% \textbf{400 words}

% \begin{itemize}
%     \it
%     \item MAD-X, sixtrack success with LHC
%     \item Issues with interfacing etc
%     \item FCC pushing the boundaries needs new tools (maybe all future projects...)
% \end{itemize}

Particle accelerators are complex engineering marvels, so it is no surprise that for decades computer simulations have been central to their design, study, and operation. CERN has long been at the forefront of developing dedicated simulation tools, each created to investigate one of the many behaviours exhibited by charged particles as they are accelerated and steered.

Since the late 60s, computer programs have been used to compute and design the orbit and optics of particle beams in CERN synchrotrons and related transfer and experimental lines. In the 80s, as part of the LEP collider design, the MAD program was developed and later evolved into MAD-X, which became the de-facto standard in optics calculations and accelerator operation at CERN during the LHC era.

In parallel to optics software, increasing computing power enabled simulation of individual trajectories over thousands or even millions of revolutions. This opened the door to more complex studies on beam-quality preservation in the presence of non-linear forces and magnet imperfections, known as Dynamic Aperture studies. At CERN, SIXTRACK was developed, inspired by an earlier tool created for HERA at DESY. Like MAD-X, SIXTRACK became a standard for the LHC era in this context.

Further tools were developed over the years for specific phenomena. For example, HEADTAIL and its evolution PyHEADTAIL have been the workhorses for simulating transverse collective instabilities. Collectively, these tools represent decades of expertise from which the accelerator community benefits every day.

However, as studies became more sophisticated, several limitations of these legacy tools emerged. Investigating the interplay of different physical phenomena was challenging and slow due to ad-hoc interfaces between codes. Extending the programs to support new effects proved difficult because they were not designed with extensibility in mind, and many of the experts familiar with the original technologies had moved on. Meanwhile, the promise of GPU-accelerated workflows became increasingly attractive for accelerator physics.

With these needs in mind, the Xsuite project launched in 2021, 
with the goal of providing the functionality of MAD-X, SIXTRACK and PyHEADTAIL within a modern, easily extendable Python-based toolkit, with GPU acceleration and collective effects built in by design. Access to accelerator design and simulation tools in Python makes it effortless to use them alongside state-of-the-art scientific packages for data analysis, visualisation, optimization, artificial intelligence, and more. These advantages are especially important for future accelerator projects that push the boundaries of what has so far been possible in simulation, both because of the demands of advanced physics modeling and because the scale and complexity of projects require exploiting modern computing hardware to its fullest.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Approach and Capabilities
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Approach and Capabilities}
% \textbf{Szymon}
% \textbf{400 words}

% \begin{itemize}
%     \it
%     \item Approach taken (agile development)
%     \item Xobjects packages and use of CUPY etc
%     \item Physics packages
% \end{itemize}

Xsuite uses an orthogonal architecture: the codebase is split into independent functional blocks with clean, well-defined interfaces. The physics modules include Xtrack (particle tracking), Xpart (particle distributions), Xfields (electromagnetic fields from particle ensembles), Xcoll (particle–matter interaction and collimation), and Xwakes (wakefields and impedances). They sit atop two foundations: Xobjects, an interface to multi-core CPUs and Nvidia/AMD GPUs; and Xdeps, which manages parameter dependencies.
This modular structure lowers codebase complexity so the toolkit scales better as it grows. It also makes the software easier to understand and contribute to, and, as a result, Xsuite users frequently implement and upstream the capabilities they need.

From the start, Xsuite development has been user-centric, delivering functionality in response to concrete needs and testing on real use cases. This mirrors ``Agile'' principles: close collaboration with users and incremental evolution driven by feedback.

Thanks to sustained investment in continuous testing, Xsuite supports a fast release cycle with new versions appearing multiple times per month. Every night, comprehensive tests run automatically to ensure that on all supported computing platforms Xsuite behaves as expected and that regressions from either the developers or third-party dependencies are caught early. The test suite combines small unit tests with real-life simulation scenarios, boosting confidence in both the development process and the results obtained from Xsuite-based studies.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Collaboration
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \subsection{Collaboration}
% \textbf{Giacomo}
% \textbf{200 words}

% \begin{itemize}
%     \item With other codes
%     \begin{itemize}
%         \item MADNG
%         \item RF-Track
%         \item BDSIM
%         \item GEANT4
%         \item FLUKA
%         \item BLonD
%     \end{itemize}
%     \item Open source
%     \item Other labs
%     \item Teachin (USPAS, JUAS, CAS...)
%     \item Potentially an image here? World map with points for accelerators that have in some way used Xsuite
% \end{itemize}


A key strength of Xsuite is its ability to interface naturally with other simulation codes. This makes it possible to build detailed, realistic models that combine multiple physical effects. Integration with FLUKA and BDSIM-Geant4, for example, enables in-depth studies of particle–matter interactions across the accelerator environment, while interfaces with RF-track and BLonD extend simulations to include complex electromagnetic fields and RF feedback systems.

Xsuite is now the simulation tool for all synchrotrons operating at CERN, as well as for upgrade projects and design studies. It has also been embraced by laboratories including GSI, HIT, MedAustron, DESY, and BESSY in Europe; Fermilab and BNL in the US; the Canadian Light Source; and JPARC and KEK in Japan. A clear sign of Xsuite’s growing adoption is the steady rise in mentions in recent IPAC proceedings—now surpassing those of MAD-X, which for years was among the most broadly adopted tools in the community—as shown in Fig.~\ref{fig:ipac_citations}.

Its open-source nature is an important driver of Xsuite’s success. Being freely available encourages collaboration, transparency, and innovation, and has led to rapid adoption by accelerator laboratories around the world. Many of these institutions now rely on Xsuite in their design and operation workflows, contributing improvements and helping to shape the tool’s evolution. 

Beyond research labs, Xsuite has also made its way into the classroom. It is taught at the main accelerator schools, including the CERN Accelerator School (CAS), the Joint Universities Accelerator School (JUAS), and the U.S. Particle Accelerator School (USPAS), giving the next generation of accelerator physicists hands-on experience with tools directly applicable to the machines they will go on to build and operate.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Novel applications
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Application examples}

\subsection*{High-luminosity lepton colliders}

Following the great success of the integrated LEP and LHC program, the next highest energy collider studies are looking towards lepton colliders prior to larger hadron machines. This is the case for the FCC study at CERN, or CEPC study at IHEP.

The current state-of-the-art high-luminosity lepton collider is SuperKEKB, located at KEK in Tsukuba, Japan.
SuperKEKB holds the world record for luminosity—a measure of the collision rate a collider can produce.
This three-kilometre electron–positron collider sets the benchmark to which the next generation of machines aspire.
As SuperKEKB strives to realise its ambitious target parameters, simulation developments have been key to understanding observations and optimising the machine configuration.
Work to model SuperKEKB has driven developments of the Xsuite code and strengthened collaboration between CERN and KEK.
Supported strongly by international schemes, such as the European Union’s Europe America Japan Accelerator Development Exchange (EAJADE), we are benefiting greatly from the increase in knowledge sharing between our organisations.


A defining feature of Xsuite is that its components plug together cleanly, enabling seamless integration of different simulation blocks. This makes it practical to study complex scenarios with multiple beam-dynamics effects at once—a capability that is becoming increasingly essential, for example, in the context of the FCC-ee design.
In this context, a wide range of phenomena must be accounted for: accurate modeling of thousands of magnetic and RF elements,
synchrotron radiation emission, magnet strength tapering to follow local beam energy, beam–beam interactions, beamstrahlung, scattering with collimators, and more. Xsuite provides the framework to simulate these effects concurrently, in a self-consistent and flexible way.
As an example, the figure below shows the distribution of beam losses around the FCC-ee ring as obtained from integrated simulations performed with Xsuite in the presence of all relevant physical effects mentioned above.
Such studies are crucial for validating that the machine can operate safely while delivering its target luminosity to the experiments. They provide a deeper understanding of how various physical effects interact and help guide key design decisions early in the project lifecycle.

\subsection*{Multispecies simulations - application to hadron therapy}

Particle accelerators typically only accelerate one type of particle at a time: a “single species”. Nevertheless as beams are circulating, “secondary particles” can be generated when beam particles hit the surface of beam pipes or collimators. Modeling the behavior of these secondary particles is important to protect sensitive accelerator elements like superconducting magnets and cavities as well as experimental detectors. For this purpose Xsuite has been designed to support simultaneous tracking of different particle species. This feature is regularly used for collimation studies for the LHC complex and for the FCC design, and it is also proving valuable for advanced studies in hadron therapy.
Two particle species of great interest for hadron therapy are carbon and helium. Their properties align just right to allow them to propagate at the same time in the same ring. Studies by a collaboration at MedAustron in Austria are working on using beams made of a mix of the two species for “online range verification” during patient irradiation. In practice, while the accelerated carbon ions are deposited in the area to be treated, for example a tumor, the helium ions pass through the patient and can be used for precise localization of the beam. The research team is using Xsuite to simulate and optimize this novel therapy technique.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SuperKEKB
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Figure

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Towards Operation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Towards Operation}
% \textbf{Szymon}
% \textbf{150 words}
% \begin{itemize}
%     \it
%     \item Current operational controls run in MADX
%     \item Move towards Xsuite
%     \item Support across the board
%     \item Towards HL!
% \end{itemize}

By now Xsuite has organically become the production tool for over a hundred accelerator physicists.
The advantages of having a large and diverse community working with the same toolkit are tangible,
in terms of synergies across different projects, shared expertise, community support to new users,
and collective validation of results.

Work is now focused on bringing Xsuite into the control room, in particular integrating the
toolkit with the CERN Layout Database and the accelerator control system, 
allowing the operation teams to use Xsuite to analyze, generate and manipulate
accelerator configurations based on the simulation models.
Early control-room tests have been very positive—including a Machine Development session where a full proof-of-concept LHC cycle was designed entirely with Xsuite and tested in the machine. Beyond the practical advantages of a modern, supported toolchain, this also opens opportunities for tighter synergy and mobility between teams designing future machines and those operating today’s accelerators.


\section*{Get involved}
If Xsuite is relevant for your work, give it a try—the team is eager to hear your feedback.

\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TODO and References
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\onecolumn


\subsection*{Key References}
\begin{itemize}
    \item \href{https://indico.cern.ch/event/1439972/contributions/6159162/attachments/2983771/5257782/Beam_Physics_Simulation_Software.pdf}{Szymon JAP Talk}
    \item \href{https://cds.cern.ch/record/2826497/files/CERNCourier2022SepOct-digitaledition.pdf}{Molflow courier article}
    \item \href{https://codimd.web.cern.ch/s/BrhfxadhH}{Notes for the JAP presentation have a section about past BD software}
\end{itemize}

\begin{figure}[tb]
    \centering
    \includegraphics[width=0.9\linewidth]{xsuite_logo_alpha.eps}
    \label{fig:xsuite_logo}
\end{figure}

\begin{figure}[tb]
    \centering
    \includegraphics[width=0.9\linewidth]{ipac_citations.png}
    \caption{Mentions of Xsuite packages in IPAC proceedings over time, compared with MAD-X.}
    \label{fig:ipac_citations}
\end{figure}

\begin{figure}[tb]
    \centering
    \includegraphics[width=0.9\linewidth]{all4.png}
    \caption{Visualisation of the beam envelopes (at $3\sigma$ with 6.8 TeV energy and $\beta^* = 30 \textrm{ cm}$) including the apertures around ATLAS, ALICE, CMS, LHCb (left to right, top to bottom), which was generated using Xsuite. Scale of the longitudinal to transverse axes: 3m : 1cm.}
\end{figure}

\begin{figure}[tb]
    \centering
    \includegraphics[width=0.9\linewidth]{fcc_loss_map.png}
    \caption{Example loss map from an integrated FCC-ee simulation produced with Xsuite.}
    \label{fig:fcc_loss_map}
\end{figure}

\begin{figure}[hb]
    \centering
    \includegraphics[width=0.6\linewidth]{medaustron.png}
    \includegraphics[width=0.6\linewidth]{medaustron2.png}
    \caption{Co-propagating Carbon and Helium ions in the Proton Ion Medical Machine Study lattice.
    Under study at MedAustron, aiming for use in radiotherapy treatment, where the carbon will deposit in the tumours, and the helium pass through for imaging.
    arXiv:2501.12797v1}
    \label{fig:pimms_figure}
\end{figure}

\end{document}
