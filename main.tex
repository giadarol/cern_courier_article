%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Preamble
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[twocolumn, 12pt]{article}
\input{preamble}

\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Title, tagline and cover image
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{strip}

{
    \fontsize{24pt}{24pt}\selectfont
    Xsuite: A CERN Courier Placeholder Title!
}\\




\end{strip}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Motivation and Background
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \textbf{Szymon}
% \textbf{400 words}

% \begin{itemize}
%     \it
%     \item MAD-X, sixtrack success with LHC
%     \item Issues with interfacing etc
%     \item FCC pushing the boundaries needs new tools (maybe all future projects...)
% \end{itemize}

Particle accelerators are complex engineering marvels, so it is no surprise that for decades computer simulations have been key in their design, study, and operation. Historically, CERN has been at the forefront of development of the dedicated simulation tools, each created to investigate one of the many behaviours exhibited by charged particles as we accelerate and steer their trajectories in our accelerators.

From the late 60s computer programs have been used to compute and design the orbit and optics of particle beams in CERN synchrotrons and related transfer and experimental lines. In the 80s, as part of the LEP collider design, the MAD program was developed and later evolved into MAD-X, which emerged as the de-facto standard in optics calculations and operation of accelerators at CERN during the LHC era.

In parallel to the development of optics software, as computing power became more and more abundant, the idea of simulating individual trajectories of thousands or even millions of revolutions became of interest. This enabled more complex studies on beam-quality preservation, e.g. in presence of non-linear forces and magnet imperfections, which are known as Dynamic Aperture studies. At CERN, SIXTRACK was developed, inspired by an earlier endeavour created for the needs of HERA at DESY. In a similar fashion to MAD-X, SIXTRACK became the standard for the LHC era in this context.

Many more tools have also been developed over the years for the study of specific phenomena. For example HEADTAIL and its evolution PyHEADTAIL have been the workhorse to simulate transverse collective instabilities.

All of these tools represent decades of expertise and experience from which the accelerator community benefits every day.

However, as studies became more sophisticated, several limitations of these legacy tools emerged. Studies of the interplay of different physical phenomena were challenging and slow due to ad-hoc interfaces between the different tools. It proved difficult to extend legacy programs to support new phenomena too, as they were not designed with extensibility in mind, and the experts familiar with the technologies behind them had moved on. In the meantime, the promise of performance leaps of GPU-accelerated workflows started looking increasingly desirable for accelerator physics as well.

With these needs in mind, the Xsuite project launched in 2021, 
with the goal of providing the functionality of MAD-X, SIXTRACK and PyHEADTAIL within a modern, easily extendable Python-based toolkit, with the support of GPU acceleration and collective effects built-in by design. Having access to accelerator design and simulation functionalities in Python implies that it is effortless to use them side-by-side with the plethora of other state-of-the-art scientific tools for data analysis, visualisation, optimization, Artificial Intelligence, etc. These advantages are especially important in the context of the future accelerator projects, which are pushing the boundaries of what had been so far possible in simulation, on one hand because of the requirements of advanced physics modeling, and on the other hand, because, as the scale and complexity of projects grow, it becomes mandatory to exploit state-of-the-art computing hardware to its fullest potential.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Approach and Capabilities
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Approach and Capabilities}
% \textbf{Szymon}
% \textbf{400 words}

% \begin{itemize}
%     \it
%     \item Approach taken (agile development)
%     \item Xobjects packages and use of CUPY etc
%     \item Physics packages
% \end{itemize}

Xsuite uses an orthogonal design architecture, meaning that the codebase is split as much as possible into independent functional blocks, with a focus on clean and well-defined interfaces between them. The physics modules of Xsuite include: Xtrack (the particle tracking engine), Xpart (used for generating particle distributions), Xfields (compute electromagnetic fields from particle ensembles), Xcoll (particle-matter interaction and collimation), and Xwakes (for computing wakefields and impedances). These sit atop a foundation consisting of two additional modules, Xobjects and Xdeps: the former acts as interface with various types hardware (such as multi-core CPUs as well as Nvidia and AMD GPUs), while the latter is used for managing parameter dependencies.
These independent functional blocks help lower the complexity of the codebase, so that it scales better as the toolkit grows. It also makes it easier to understand and to contribute to source code. As a result, Xsuite users have often contributed to the development, implementing themselves the functionalities they needed. 

Xsuite's development has been from the very beginning user-centric, focusing on implementing functionalities in response to users' needs, benefiting from their involvement, and testing on their concrete use cases. This closely corresponds to the ``Agile'' development principles: the focus is on collaboration with users, with the software evolving incrementally in response to user's feedback and needs.

Thanks to an investment in continuous testing, Xsuite can afford a fast release cycle with new versions coming out multiple times a month. Every night, comprehensive tests run automatically to ensure that, on all supported computing platforms, Xsuite performs as it should, and that no issues have been inadvertently introduced either by the developers, or as a result of third party dependencies. The automatic test suite comprises both small unit tests and an array of real-life simulation scenarios, greatly increasing the confidence both in the development process, as well as all of the results obtained in simulation studies based on Xsuite.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Collaboration
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \subsection{Collaboration}
% \textbf{Giacomo}
% \textbf{200 words}

% \begin{itemize}
%     \item With other codes
%     \begin{itemize}
%         \item MADNG
%         \item RF-Track
%         \item BDSIM
%         \item GEANT4
%         \item FLUKA
%         \item BLonD
%     \end{itemize}
%     \item Open source
%     \item Other labs
%     \item Teachin (USPAS, JUAS, CAS...)
%     \item Potentially an image here? World map with points for accelerators that have in some way used Xsuite
% \end{itemize}


A key strength of Xsuite lies in its ability to interface naturally with other simulation codes. This makes it possible to build detailed and realistic models that combine multiple physical effects. For example, integration with FLUKA and BDSIM-Geant4 enables in-depth studies of particle–matter interactions across the accelerator environment. In parallel, interfaces with RF-track and BLonD extend simulations to cover tracking in complex electromagnetic fields and in the presence of RF feedback systems.

Xsuite has been adopted as the simulation tool for all synchrotrons operating at CERN, as well as for upgrade projects and design studies, and has been embraced by other laboratories including GSI, HIT, MedAustron, DESY, BESSY in Europe, Fermilab and BNL in the US, the Canadian Light Source, JPARC and KEK in Japan. An indication of Xsuite’s rapidly growing adoption across the accelerator community is the steady rise in mentions in recent IPAC proceedings — now surpassing those of MAD-X, which for years has been among the most broadly adopted tools in the community — as shown in figure.

An important driver of Xsuite’s growing success is its open-source nature. Being freely available encourages collaboration, transparency, and innovation, and has led to rapid adoption by accelerator laboratories around the world. Many of these institutions now rely on Xsuite in their design and operation workflows, contributing back improvements and helping to shape the tool’s evolution. 

% \textbf{ADD A WORD ON IPAC CITATION, mention applications outside CERN}

Beyond research labs, Xsuite has also made its way into the classroom. It is now being taught at the main accelerator schools, including the CERN Accelerator School (CAS), the Joint Universities Accelerator School (JUAS), and the U.S. Particle Accelerator School (USPAS). This is helping to train the next generation of accelerator physicists with hands-on experience using tools that are directly applicable to the machines they will go on to build and operate.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Novel applications
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Application examples}

\subsection{Multispecies simulations for collimation and hadron therapy}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Multispecies Tracking
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \subsection{Multispecies Tracking}
% \textbf{Jack}
% \textbf{300 words (currently ~250)}

% \begin{itemize}
%     \item Standard is one type of particle in a machine
%     \item With the exception of secondary particles....
%     \item Born out of needs of collimation, now support multi-species tracking
%     \item Other uses for two ions?
%     \item Introduce PIMMS
%     \item Slight background of medical application
%     \item 2 Ions species in on machine and why this is beneficial
% \end{itemize}

Particle accelerators typically only accelerate one type of particle at a time: a ‘single species’. Nevertheless as beams are circulating, ``secondary particles' can be generated when beam particles hit the surface of beam pipes or collimators. Modeling the behavior of these secondary particles is important to protect sensitive accelerator elements like superconducting magnets and cavities as well as experimental detectors. For this purpose Xsuite has been designed to support simultaneous tracking of different particle species. This feature is regularly used for collimation studies for the LHC complex and for the FCC design, and turn out to be useful also for advanced studies in the field of hadron therapy.
Two particle species of great interest for hadron therapy are Carbon and Helium. It turns out that the properties of such species align just right to allow them to propagate at the same time in the same ring. Studies by a collaboration at MedAustron in Austria are working on using beams made of a mix of the two species for ``online range verification'' during the patient irradiation. In practice, while the accelerated carbon ions are deposited in the area to be treated, for example a tumor, the helium ions go through the patient and can be used for precise localization of the beam. The research team is using Xsuite to simulate and optimize this novel therapy technique.

\begin{figure}[htb]
    \centering
    \includegraphics[width=0.9\linewidth]{medaustron.png}
    \includegraphics[width=0.9\linewidth]{medaustron2.png}
    \caption{Co-propagating Carbon and Helium ions in the Proton Ion Medical Machine Study lattice.
    Under study at MedAustron, aiming for use in radiotherapy treatment, where the carbon will deposit in the tumours, and the helium pass through for imaging.
    arXiv:2501.12797v1}
    \label{fig:pimms_figure}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SuperKEKB
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Novel Accelerators}
% \textbf{Jack}
% \textbf{300 words (currently 250)}

% \begin{itemize}
%     \item Modelling of novel accelerators represents its own challenges
%     \item Next priority is ee (no ee at CERN at the moment)- model something that exists
%     \item Mentioned at start the needs of FCC driving development, but this isn't the only novel machine
%     \item More collaboration with Japan under EAJADE and secondments
%     \item Introduce SuperKEKB (current highest luminosity e+e-)
%     \item Challenges of SuperKEKB required improvements to Xsuite
%     \item Overlapping elements in the Solenoid field
% \end{itemize}

% It is an exciting time in the world of accelerator physics.
% In the coming years, many design projects are seeking approval, several new accelerators are expected to power on for the first time and the current top-of-the-line machines continue to strive for new heights.
% With the great success of the LHC, and the move towards the High-Luminosity LHC, CERN is setting the benchmark for hadron colliders.
Following the great success of the integrated LEP and LHC program, the next highest energy collider studies are looking towards lepton colliders prior to larger hadron machines, such as the FCC study at CERN, or CEPC study at IHEP.

The current state-of-the-art high-luminosity lepton collider is SuperKEKB, located at KEK, Tsukuba Japan.
SuperKEKB holds the current world record for luminosity (a measure of the data rate a collider can produce).
A three kilometre electron-positron collider, SuperKEKB sets the benchmark which the next generation of machines continue to look to.
As SuperKEKB strives to realise their ambitious target parameters, simulation developments have been key to understand observations and optimize the machine configuration.
The effort to describe SuperKEKB has led to not only developments of the Xsuite code, but further developments of the collaborative links between CERN and our colleagues at KEK.
Supported strongly by international schemes, such as the European Union’s Europe America Japan Accelerator Development Exchange (EAJADE) scheme, we are benefitting greatly from the increase in knowledge sharing between our organisations.



\begin{figure}[htb]
    \centering
    \includegraphics[width=0.9\linewidth]{example-image-a}
    \caption{SuperKEKB Figure}
    \label{fig:skekb_figure}
\end{figure}
    
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Combined Effect Simulations
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% JS: I'm not sure about this title, as is true of SKEKB etc too, but perhaps still works
\subsection{Combined effect simulations}
% \textbf{Giacomo}
% \textbf{300 words}

One of Xsuite’s defining features is its modular architecture, which allows different simulation modules to be seamlessly integrated. This modularity enables the study of complex scenarios where multiple beam dynamics effects must be considered simultaneously—a capability that is becoming increasingly essential, for example, in the context of the FCC-ee design.
In this context, a wide range of phenomena must be accounted for: accurate modeling of thousands od magnetic and RF elements,
synchrotron radiation emission, magnet strength tapering to follow local beam energy, beam–beam interactions, beamstrahlung, scattering with collimators, and more. Xsuite provides the framework to simulate these effects concurrently, in a self-consistent and flexible way.
As an example, the figure below shows the distribution of beam losses around the FCC-ee ring as obtained from integrated simulations performed with Xsuite, in the presence of all relevant physical effects mentioned above.
Such studies are crucial for validating that the machine can operate safely while delivering its target luminosity to the experiments. They provide a deeper understanding of how various physical effects interact and help guide key design decisions early in the project lifecycle.

% Figure

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Towards Operation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Towards Operation}
% \textbf{Szymon}
% \textbf{150 words}
% \begin{itemize}
%     \it
%     \item Current operational controls run in MADX
%     \item Move towards Xsuite
%     \item Support across the board
%     \item Towards HL!
% \end{itemize}

By now Xsuite has organically become the production tool for over a hundred accelerator physicists.
The advantages of having a large and diverse community working with the same toolkit are tangible,
in terms of synergies across different projects, shared expertise, community support to new users,
and collective validation of results.

Work is now focused on bringing Xsuite into the control room, in particular integrating the
toolkit with the CERN Layout Database and the accelerators control system, 
allowing the operation teams to use Xsuite to analyze, generate and manipulate
accelerator configurations, based on the simulation models.
Early control-room tests have been very positive - including a Machine Development session where a full proof-of-concept LHC cycle was designed entirely with Xsuite and tested in the machine. Beyond the practical advantages of a modern, supported toolchain, this also opens opportunities for tighter synergy and mobility between teams designing future machines and those operating today’s accelerators.



\begin{figure}[htb]
    \centering
    \includegraphics[width=0.9\linewidth]{xsuite_logo_alpha.eps}
    \label{fig:xsuite_logo}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% TODO and References
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\onecolumn
\section*{TODO}
\begin{itemize}
    \item Image: LHC sausage beams \textbf{Szymon}
    \item Image: SuperKEKB (TBD) \textbf{Jack}
    \item Image: PIMMS (Austria) 2 species \textbf{Collaborator}
    \item Image: World map with all the machines using Xsuite
\end{itemize}

\subsection*{Key References}
\begin{itemize}
    \item \href{https://indico.cern.ch/event/1439972/contributions/6159162/attachments/2983771/5257782/Beam_Physics_Simulation_Software.pdf}{Szymon JAP Talk}
    \item \href{https://cds.cern.ch/record/2826497/files/CERNCourier2022SepOct-digitaledition.pdf}{Molflow courier article}
    \item \href{https://codimd.web.cern.ch/s/BrhfxadhH}{Notes for the JAP presentation have a section about past BD software}
\end{itemize}

\begin{center}
    \includegraphics[width=0.9\linewidth]{all4.png}
    \captionof{figure}{Visualisation of the beam envelopes (at $3\sigma$ with 6.8 TeV energy and $\beta^* = 30 \textrm{ cm}$) including the apertures around ATLAS, ALICE, CMS, LHCb (left to right, top to bottom), which was generated using Xsuite. Scale of the longitudinal to transverse axes: 3m : 1cm.}
\end{center}

\begin{figure}[htb]
    \centering
    \includegraphics[width=0.9\linewidth]{ipac_citations.png}
    \caption{Mentions of Xsuite packages in IPAC proceedings over time, compared with MAD-X.}
    \label{fig:ipac_citations}
\end{figure}

\begin{figure}[htb]
    \centering
    \includegraphics[width=0.9\linewidth]{fcc_loss_map.png}
    \caption{Example loss map from an integrated FCC-ee simulation produced with Xsuite.}
    \label{fig:fcc_loss_map}
\end{figure}

\end{document}
